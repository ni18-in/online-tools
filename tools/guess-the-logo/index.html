<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess the Logo - Fun Brand Quiz Game</title>
    <meta name="description"
        content="Test your brand knowledge with Guess the Logo! A fun and addictive quiz game with multiple modes, difficulty levels, and endless logo challenges. Play now in your browser!">
    <meta name="keywords"
        content="guess the logo, logo quiz, brand game, trivia game, online game, browser game, party game, challenge game, html game, javascript game">

    <meta property="og:title" content="Guess the Logo - Fun Brand Quiz Game">
    <meta property="og:description"
        content="Test your brand knowledge with Guess the Logo! Multiple modes, difficulty levels, and endless challenges.">
    <meta property="og:type" content="website">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;800&family=Poppins:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* Modern Palette - Light Mode */
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-border: 1px solid rgba(255, 255, 255, 0.5);
            --text-primary: #1e293b;
            --text-secondary: #64748b;

            /* Actions */
            --brand-primary: #4f46e5;
            /* Indigo */
            --brand-secondary: #ec4899;
            /* Pink */

            /* States */
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;

            /* Effects */
            --glass-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
            --neon-glow: 0 0 10px rgba(79, 70, 229, 0.3);

            /* Typography */
            --font-heading: 'Outfit', sans-serif;
            --font-body: 'Poppins', sans-serif;
            --border-radius-lg: 1.5rem;
            --border-radius-md: 1rem;
        }

        .dark-mode {
            /* Modern Palette - Dark Mode */
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
            --card-bg: rgba(30, 41, 59, 0.8);
            --card-border: 1px solid rgba(255, 255, 255, 0.1);
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;

            --brand-primary: #818cf8;
            --brand-secondary: #f472b6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-gradient);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            padding: 1rem;
        }

        /* Animated Background Pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(79, 70, 229, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 20%);
            z-index: -1;
            pointer-events: none;
        }

        .container {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: var(--card-border);
            padding: 3rem 2rem;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--glass-shadow);
            width: 100%;
            max-width: 600px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        /* Decorative "Mesh" top bar */
        .container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary));
        }

        h1 {
            font-family: var(--font-heading);
            font-size: 2.75rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.05em;
            line-height: 1.2;
        }

        h2 {
            font-family: var(--font-heading);
            font-size: 1.5rem;
            color: var(--text-secondary);
            font-weight: 500;
            margin-bottom: 2rem;
        }

        /* Custom Scrollbar for Highscores */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-secondary);
            border-radius: 4px;
            opacity: 0.5;
        }

        /* Game Screens Transition */
        .screen {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Settings Styles */
        .settings-group {
            background: rgba(0, 0, 0, 0.03);
            border-radius: var(--border-radius-md);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: left;
            border: 1px solid transparent;
        }

        .dark-mode .settings-group {
            background: rgba(255, 255, 255, 0.03);
        }

        .settings-group legend {
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--brand-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Custom Inputs */
        select,
        input[type="number"] {
            width: 100%;
            padding: 1rem;
            border-radius: var(--border-radius-md);
            border: 2px solid transparent;
            background: var(--bg-gradient);
            color: var(--text-primary);
            font-family: var(--font-heading);
            font-weight: 600;
            cursor: pointer;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        select:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: var(--brand-primary);
            background: var(--card-bg);
        }

        /* Logo Display Area */
        .logo-container {
            position: relative;
            background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(240, 240, 250, 1) 100%);
            padding: 2rem;
            border-radius: var(--border-radius-lg);
            margin-bottom: 2rem;
            min-height: 220px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .dark-mode .logo-container {
            background: radial-gradient(circle, rgba(40, 40, 50, 1) 0%, rgba(20, 20, 30, 1) 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .logo-container img {
            max-width: 100%;
            max-height: 200px;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.15));
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Buttons */
        .btn {
            font-family: var(--font-heading);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        /* Primary Action Button (Start Game) */
        .btn-primary {
            width: 100%;
            padding: 1.2rem;
            font-size: 1.2rem;
            border-radius: 50px;
            /* Pill shape */
            background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(79, 70, 229, 0.5);
        }

        /* Option Buttons */
        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            perspective: 1000px;
        }

        @media (max-width: 500px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .btn-option {
            background: var(--text-primary);
            /* Inverted for high contrast */
            color: var(--card-bg);
            padding: 1rem;
            border-radius: var(--border-radius-md);
            font-size: 1rem;
            opacity: 0.9;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .dark-mode .btn-option {
            background: #334155;
            color: white;
        }

        .btn-option:hover:not(:disabled) {
            transform: translateY(-2px) rotateX(5deg);
            opacity: 1;
            background: var(--brand-primary);
            color: white;
        }

        /* Feedback States */
        .btn-option.correct {
            background: var(--success-color) !important;
            color: white !important;
            animation: rubberBand 0.8s;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.4);
        }

        .btn-option.incorrect {
            background: var(--error-color) !important;
            color: white !important;
            animation: shake 0.5s;
        }

        @keyframes rubberBand {
            0% {
                transform: scale3d(1, 1, 1);
            }

            30% {
                transform: scale3d(1.25, 0.75, 1);
            }

            40% {
                transform: scale3d(0.75, 1.25, 1);
            }

            50% {
                transform: scale3d(1.15, 0.85, 1);
            }

            65% {
                transform: scale3d(0.95, 1.05, 1);
            }

            75% {
                transform: scale3d(1.05, 0.95, 1);
            }

            100% {
                transform: scale3d(1, 1, 1);
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            20%,
            60% {
                transform: translateX(-10px);
            }

            40%,
            80% {
                transform: translateX(10px);
            }
        }

        /* HUD (Heads Up Display) */
        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.03);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            margin-bottom: 2rem;
            font-family: var(--font-heading);
            font-weight: 700;
        }

        .dark-mode .game-info {
            background: rgba(255, 255, 255, 0.05);
        }

        #timer-display {
            color: var(--brand-secondary);
            font-variant-numeric: tabular-nums;
        }

        /* Feedback Message */
        .feedback-message {
            margin-top: 1.5rem;
            font-weight: 700;
            font-size: 1.2rem;
            min-height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            border-radius: var(--border-radius-md);
        }

        .feedback-message.correct {
            color: var(--success-color);
            background: rgba(16, 185, 129, 0.1);
        }

        .feedback-message.incorrect {
            color: var(--error-color);
            background: rgba(239, 68, 68, 0.1);
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            font-size: 1.2rem;
            background: transparent;
            color: var(--text-secondary);
            border: 2px solid var(--text-secondary);
            padding: 0.5rem;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .dark-mode-toggle:hover {
            color: var(--brand-primary);
            border-color: var(--brand-primary);
            transform: rotate(15deg);
        }


        /* Game Over Screen */
        #highscore-list {
            list-style: none;
            padding: 0;
            text-align: left;
            max-height: 220px;
            overflow-y: auto;
            border: 1px solid var(--card-border-color, var(--light-input-border));
            border-radius: var(--border-radius);
            padding: 0.75rem;
            background-color: rgba(0, 0, 0, 0.02);
        }

        .dark-mode #highscore-list {
            background-color: rgba(255, 255, 255, 0.05);
        }

        /* Highscore List */
        #highscore-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #highscore-list li {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid var(--text-secondary);
            color: var(--text-primary);
            display: flex;
            justify-content: space-between;
            font-weight: 500;
            opacity: 0.9;
        }

        #highscore-list li:last-child {
            border-bottom: none;
        }

        #highscore-list li:nth-child(odd) {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .dark-mode #highscore-list li:nth-child(odd) {
            background-color: rgba(255, 255, 255, 0.05);
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: 10% auto;
            padding: 2.5rem;
            border: var(--card-border);
            width: 90%;
            max-width: 600px;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--glass-shadow);
            position: relative;
            color: var(--text-primary);
        }

        .modal-content h3 {
            font-family: var(--font-heading);
            font-size: 1.8rem;
            color: var(--brand-primary);
            margin-bottom: 1rem;
        }

        .modal-content p,
        .modal-content ul {
            margin-bottom: 1rem;
            line-height: 1.7;
            color: var(--text-secondary);
        }

        .modal-content ul {
            padding-left: 1.5rem;
        }

        .modal-content strong {
            color: var(--text-primary);
        }

        .close-btn {
            color: var(--text-secondary);
            float: right;
            font-size: 2rem;
            font-weight: bold;
            line-height: 0.8;
            cursor: pointer;
            transition: color 0.2s;
        }

        .close-btn:hover {
            color: var(--error-color);
        }

        /* Message Box */
        .message-box {
            position: fixed;
            top: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-bg);
            border: 1px solid var(--warning-color);
            color: var(--warning-color);
            padding: 1rem 2rem;
            border-radius: 50px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            z-index: 2000;
            display: none;
            font-weight: 700;
            animation: slideDown 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .dark-mode .message-box {
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--brand-primary);
        }

        .message-box.visible {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translate(-50%, -20px);
            }

            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        /* Party & Streaming Mode overrides */
        .party-mode .container,
        .streaming-mode .container {
            max-width: 95vw;
        }

        .party-mode .logo-container img,
        .streaming-mode .logo-container img {
            max-height: 40vh;
        }

        .party-mode .game-info,
        .streaming-mode .game-info {
            font-size: 1.5rem;
        }

        .streaming-mode .options-container,
        .streaming-mode #scoreDisplay,
        .streaming-mode #roundDisplay {
            display: none;
        }

        .streaming-mode #streamingModeTitle {
            display: block;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        /* Mobile Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 1.5rem;
            }

            h1 {
                font-size: 2rem;
            }

            .btn-primary {
                font-size: 1rem;
                padding: 1rem;
            }

            .options-container {
                grid-template-columns: 1fr;
            }

            .logo-container {
                min-height: 180px;
                padding: 1rem;
            }

            .logo-container img {
                max-height: 150px;
            }

            .settings-actions {
                flex-direction: column;
                gap: 0.5rem;
            }
        }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "VideoGame",
      "name": "Guess the Logo",
      "alternateName": "Logo Quiz Game",
      "description": "Test your brand knowledge with Guess the Logo! A fun and addictive quiz game with multiple modes (Single Player, Party Mode, Challenge Mode, Streaming Mode), difficulty levels, and endless logo challenges. Play now in your browser!",
      "genre": ["Trivia", "Quiz", "Puzzle"],
      "applicationCategory": "Game",
      "operatingSystem": "All (Web browser)",
      "browserRequirements": "Requires HTML5, CSS3, and JavaScript support.",
      "playMode": ["SinglePlayer", "MultiPlayer"], 
      "keywords": "guess the logo, logo quiz, brand game, trivia game, online game, browser game, party game, challenge game, html game, javascript game",
      "author": {
        "@type": "Organization",
        "name": "ni18" 
      },
      "publisher": {
        "@type": "Organization",
        "name": "ni18"
      },
      "inLanguage": "en-US",
      "isAccessibleForFree": true,
      "learningResourceType": "game",
      "typicalAgeRange": "8+",
      "numberOfPlayers": {
        "@type": "QuantitativeValue",
        "minValue": 1,
        "description": "Single player, or multiple players in Party Mode (pass and play)."
      }
      // "screenshot": "your_game_screenshot_url.jpg", // URL to a screenshot
      // "thumbnailUrl": "your_game_thumbnail_url.jpg" // URL to a thumbnail
    }
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RJER6TKTQ3" defer></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-RJER6TKTQ3');
    </script>
</head>

<body>
    <button id="darkModeToggle" class="dark-mode-toggle">ðŸŒ™</button>
    <div id="messageBox" class="message-box"></div>

    <div class="container">
        <div id="settingsScreen" class="screen active">
            <div class="settings-header">
                <h1>Guess the Logo</h1>
                <p class="subtitle">Test your brand knowledge!</p>
            </div>

            <div class="settings-actions">
                <button id="showAboutBtn" class="btn btn-info">About Game</button>
                <button id="showHowToPlayBtn" class="btn btn-info">How to Play</button>
            </div>

            <div class="settings-group">
                <label class="group-title" for="gameMode">Game Mode</label>
                <div class="radio-group" id="gameMode">
                    <input type="radio" id="modeSingle" name="gameMode" value="single" checked><label
                        for="modeSingle">Single Player</label><br>
                    <input type="radio" id="modeParty" name="gameMode" value="party"><label for="modeParty">Party
                        Mode</label><br>
                    <input type="radio" id="modeChallenge" name="gameMode" value="challenge"><label
                        for="modeChallenge">Challenge Mode</label><br>
                    <input type="radio" id="modeStreaming" name="gameMode" value="streaming"><label
                        for="modeStreaming">Streaming Mode</label>
                </div>
            </div>
            <div class="settings-group">
                <label class="group-title" for="difficulty">Difficulty</label>
                <div class="radio-group" id="difficulty">
                    <input type="radio" id="diffEasy" name="difficulty" value="easy" checked><label
                        for="diffEasy">Easy</label>
                    <input type="radio" id="diffMedium" name="difficulty" value="medium"><label
                        for="diffMedium">Medium</label>
                    <input type="radio" id="diffHard" name="difficulty" value="hard"><label for="diffHard">Hard</label>
                </div>
            </div>
            <div class="settings-group" id="roundsGroup">
                <label class="group-title" for="numRounds">Game Length</label>
                <label for="numRounds">Number of Rounds (1-200):</label>
                <input type="number" id="numRounds" value="10" min="1" max="200">
            </div>
            <div class="settings-group" id="partyTimerGroup" style="display: none;">
                <label class="group-title" for="partyTimer">Time Per Question</label>
                <label for="partyTimer">Seconds (5-60):</label>
                <input type="number" id="partyTimer" value="15" min="5" max="60">
            </div>
            <div class="settings-group" id="streamingTimerGroup" style="display: none;">
                <label class="group-title" for="streamingTimer">Reveal Speed</label>
                <label for="streamingTimer">Seconds to Reveal (3-20):</label>
                <input type="number" id="streamingTimer" value="7" min="3" max="20">
            </div>
            <div class="settings-group" id="durationGroup" style="display: none;">
                <label class="group-title" for="sessionDuration">Game Length</label>
                <label for="sessionDuration">Session Duration (minutes):</label>
                <select id="sessionDuration">
                    <option value="1">1 Minute</option>
                    <option value="2">2 Minutes</option>
                    <option value="3">3 Minutes</option>
                    <option value="5">5 Minutes</option>
                </select>
            </div>
            <div class="settings-group">
                <label class="group-title">Options</label>
                <input type="checkbox" id="soundEffects" checked>
                <label for="soundEffects">Sound Effects</label>
            </div>
            <button id="startGameBtn" class="btn btn-primary"
                style="width:100%; padding: 1.25rem; font-size: 1.4rem; margin-top:1rem;">Start Game</button>
        </div>

        <div id="gameScreen" class="screen">
            <h2 id="streamingModeTitle" style="display:none;">Guess The Logo</h2>
            <div class="game-header-info" style="text-align: center; margin-bottom: 1rem;">
                <span id="currentModeLabel"
                    style="display:inline-block; padding: 0.5rem 1rem; background: var(--brand-primary); color: white; border-radius: 20px; font-weight: 700; font-size: 0.9rem; text-transform: uppercase; margin-bottom: 0.5rem;">MODE</span>
                <p id="modeInstruction" style="color: var(--text-secondary); font-size: 1rem; margin: 0;"></p>
            </div>
            <div class="game-info">
                <span id="scoreDisplay">Score: 0</span>
                <span id="roundDisplay">Round: 1/10</span>
            </div>
            <div id="timerDisplay" style="margin-bottom: 1rem;"></div>
            <div class="logo-container">
                <img id="logoImg" src="" alt="Logo"
                    onerror="this.onerror=null; this.src='https://placehold.co/300x150/EFEFEF/AAAAAA&text=Logo+Error';">
            </div>
            <div id="optionsContainer" class="options-container">
            </div>
            <div id="feedbackMessage" class="feedback-message" style="display:none;"></div>
            <button id="nextQuestionBtn" class="btn btn-primary" style="display:none; margin-top: 1rem;">Next
                Question</button>
        </div>

        <div id="gameOverScreen" class="screen">
            <h2>Game Over!</h2>
            <p id="finalScoreDisplay" style="font-size: 1.5rem; margin-bottom: 1rem;"></p>
            <div class="settings-group" id="highscoreSection">
                <h3>High Scores</h3>
                <ul id="highscoreList">
                </ul>
            </div>
            <button id="playAgainBtn" class="btn btn-primary" style="margin-right: 0.5rem;">Play Again</button>
            <button id="shareScoreBtn" class="btn btn-secondary">Share Score</button>
        </div>
    </div>

    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeAboutModal">&times;</span>
            <h3>About Guess the Logo</h3>
            <p>Guess the Logo is a fun and challenging game designed to test your knowledge of popular brands from
                around the world!</p>
            <p>Put your brand recognition skills to the test across various difficulty levels and game modes. Whether
                you're playing solo or with friends, get ready for an exciting logo guessing adventure.</p>
            <p>This game is created with HTML, CSS, and Vanilla JavaScript, showcasing a lightweight and responsive web
                application.</p>
            <p>Enjoy playing!</p>
        </div>
    </div>

    <div id="howToPlayModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeHowToPlayModal">&times;</span>
            <h3>How to Play</h3>
            <p><strong>General Gameplay:</strong> A logo will be displayed on the screen. Your task is to choose the
                correct brand name from the four multiple-choice options provided.</p>
            <ul>
                <li><strong>Single Player Mode:</strong> Play at your own pace. Score points for each correct answer.
                    Try to achieve the highest score and make it to the leaderboard!</li>
                <li><strong>Party Mode:</strong> Perfect for playing with friends or on a larger screen! A timer adds to
                    the excitement for each question, and the game automatically advances to the next logo.</li>
                <li><strong>Challenge Mode:</strong> Race against the clock in this timed session. Answer as many logos
                    correctly as you can before your time runs out.</li>
                <li><strong>Streaming Mode:</strong> Sit back, relax, and learn! Logos and their correct answers will be
                    displayed automatically one after another. This mode is great for a quick visual quiz or
                    familiarizing yourself with brands.</li>
            </ul>
            <p><strong>Controls:</strong></p>
            <ul>
                <li>Use your <strong>mouse or tap</strong> to select an option or click buttons.</li>
                <li><strong>Keyboard:</strong> Use keys <strong>1, 2, 3, 4</strong> or <strong>A, B, C, D</strong> to
                    select the corresponding answer option. Use <strong>Enter</strong> or <strong>Spacebar</strong> for
                    primary action buttons like "Start Game", "Next Question", or "Play Again".</li>
            </ul>
            <p><strong>Settings:</strong> Before starting, you can customize your game experience:</p>
            <ul>
                <li>Choose your preferred <strong>Game Mode</strong>.</li>
                <li>Select the <strong>Difficulty</strong> (Easy, Medium, Hard).</li>
                <li>Set the <strong>Number of Rounds</strong> (for Single Player/Party Mode) or <strong>Session
                        Duration</strong> (for Challenge Mode).</li>
                <li>Toggle <strong>Sound Effects</strong> on or off.</li>
            </ul>
            <p>Have fun guessing!</p>
        </div>
    </div>


    <script>
        // DOM Elements
        const settingsScreen = document.getElementById('settingsScreen');
        const gameScreen = document.getElementById('gameScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const startGameBtn = document.getElementById('startGameBtn');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const roundDisplay = document.getElementById('roundDisplay');
        const timerDisplay = document.getElementById('timerDisplay');
        const logoImg = document.getElementById('logoImg');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackMessage = document.getElementById('feedbackMessage');
        const nextQuestionBtn = document.getElementById('nextQuestionBtn');
        const finalScoreDisplay = document.getElementById('finalScoreDisplay');
        const playAgainBtn = document.getElementById('playAgainBtn');
        const shareScoreBtn = document.getElementById('shareScoreBtn');
        const highscoreList = document.getElementById('highscoreList');
        const highscoreSection = document.getElementById('highscoreSection');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const messageBox = document.getElementById('messageBox');
        const gameModeRadios = document.querySelectorAll('input[name="gameMode"]');
        const roundsGroup = document.getElementById('roundsGroup');
        const durationGroup = document.getElementById('durationGroup');
        const numRoundsInput = document.getElementById('numRounds');
        const sessionDurationSelect = document.getElementById('sessionDuration');
        const soundEffectsCheckbox = document.getElementById('soundEffects');
        const streamingModeTitle = document.getElementById('streamingModeTitle');
        const partyTimerGroup = document.getElementById('partyTimerGroup');
        const streamingTimerGroup = document.getElementById('streamingTimerGroup');
        const partyTimerInput = document.getElementById('partyTimer');
        const streamingTimerInput = document.getElementById('streamingTimer');
        const currentModeLabel = document.getElementById('currentModeLabel');
        const modeInstruction = document.getElementById('modeInstruction');

        // Modal elements
        const aboutModal = document.getElementById('aboutModal');
        const howToPlayModal = document.getElementById('howToPlayModal');
        const showAboutBtn = document.getElementById('showAboutBtn');
        const showHowToPlayBtn = document.getElementById('showHowToPlayBtn');
        const closeAboutModal = document.getElementById('closeAboutModal');
        const closeHowToPlayModal = document.getElementById('closeHowToPlayModal');


        // Game State
        let allQuestions = [];
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let totalRounds = 10;
        let gameMode = 'single';
        let difficulty = 'easy';
        let soundEffectsEnabled = true;
        let questionTimerInterval;
        let sessionTimerInterval;
        let streamingRevealInterval;
        let streamingNextInterval;
        let timeLeft = 0;
        let partyTimerDuration = 15;
        let streamingRevealDuration = 7;
        let audioCtx;

        // Constants for streaming mode
        const STREAMING_REVEAL_TIME = 7;
        const STREAMING_NEXT_DELAY = 3;

        // --- LOGO DATA (EXPANDED) ---
        const LOGO_DATA = [
            // Easy
            { brandName: 'Apple', logoUrl: './logo/apple.png', options: ['Apple', 'Microsoft', 'Google', 'Amazon'], difficulty: 'easy' },
            { brandName: 'Nike', logoUrl: './logo/nike.png', options: ['Adidas', 'Nike', 'Puma', 'Reebok'], difficulty: 'easy' },
            { brandName: 'Coca-Cola', logoUrl: './logo/coco-cola.png', options: ['Pepsi', 'Coca-Cola', 'Sprite', 'Fanta'], difficulty: 'easy' },
            { brandName: 'McDonalds', logoUrl: './logo/mcdonalds.png', options: ['Burger King', 'KFC', 'McDonalds', 'Subway'], difficulty: 'easy' },
            { brandName: 'Starbucks', logoUrl: './logo/starbucks.png', options: ['Dunkin', 'Starbucks', 'Costa Coffee', 'Tim Hortons'], difficulty: 'easy' },
            { brandName: 'Pepsi', logoUrl: './logo/pepsi.png', options: ['Coca-Cola', 'Dr Pepper', 'Pepsi', '7 Up'], difficulty: 'easy' },
            { brandName: 'YouTube', logoUrl: './logo/youtube.png', options: ['Vimeo', 'Dailymotion', 'Twitch', 'YouTube'], difficulty: 'easy' },
            { brandName: 'Visa', logoUrl: './logo/visa.png', options: ['Mastercard', 'Visa', 'American Express', 'Discover'], difficulty: 'easy' },
            { brandName: 'Target', logoUrl: './logo/target.png', options: ['Walmart', 'Kmart', 'Target', 'Costco'], difficulty: 'easy' },
            { brandName: 'Shell', logoUrl: './logo/shell.png', options: ['BP', 'ExxonMobil', 'Chevron', 'Shell'], difficulty: 'easy' },
            { brandName: 'Ford', logoUrl: './logo/ford.png', options: ['Chevrolet', 'Ford', 'Dodge', 'Toyota'], difficulty: 'easy' },
            { brandName: 'Disney', logoUrl: './logo/disney.png', options: ['Pixar', 'DreamWorks', 'Disney', 'Warner Bros.'], difficulty: 'easy' },
            { brandName: 'KFC', logoUrl: './logo/kfc.png', options: ['McDonalds', 'Burger King', 'Popeyes', 'KFC'], difficulty: 'easy' },
            { brandName: 'Lego', logoUrl: './logo/lego.png', options: ['Playmobil', 'Lego', 'Mattel', 'Hasbro'], difficulty: 'easy' },
            { brandName: 'Subway', logoUrl: './logo/subway.png', options: ['Quiznos', 'Jimmy Johns', 'Subway', 'Potbelly'], difficulty: 'easy' },

            // Medium
            { brandName: 'Amazon', logoUrl: './logo/amazon.png', options: ['eBay', 'Alibaba', 'Amazon', 'Walmart'], difficulty: 'medium' },
            { brandName: 'Google', logoUrl: './logo/google.png', options: ['Yahoo', 'Bing', 'DuckDuckGo', 'Google'], difficulty: 'medium' },
            { brandName: 'Microsoft', logoUrl: './logo/microsoft.png', options: ['Apple', 'Microsoft', 'IBM', 'Oracle'], difficulty: 'medium' },
            { brandName: 'BMW', logoUrl: './logo/bmw.png', options: ['Mercedes', 'Audi', 'BMW', 'Volkswagen'], difficulty: 'medium' },
            { brandName: 'Adidas', logoUrl: './logo/adidas.png', options: ['Nike', 'Puma', 'Under Armour', 'Adidas'], difficulty: 'medium' },
            { brandName: 'X (Twitter)', logoUrl: './logo/x.png', options: ['Facebook', 'Instagram', 'X (Twitter)', 'Snapchat'], difficulty: 'medium' },
            { brandName: 'Instagram', logoUrl: './logo/instagram.png', options: ['Snapchat', 'TikTok', 'Instagram', 'Pinterest'], difficulty: 'medium' },
            { brandName: 'Mastercard', logoUrl: './logo/mastercard.png', options: ['Visa', 'American Express', 'Mastercard', 'PayPal'], difficulty: 'medium' },
            { brandName: 'Honda', logoUrl: './logo/honda.png', options: ['Toyota', 'Nissan', 'Honda', 'Mazda'], difficulty: 'medium' },
            { brandName: 'Audi', logoUrl: './logo/audi.png', options: ['BMW', 'Mercedes-Benz', 'Audi', 'Volkswagen'], difficulty: 'medium' },
            { brandName: 'HP (Hewlett-Packard)', logoUrl: './logo/hp.png', options: ['Dell', 'Lenovo', 'HP (Hewlett-Packard)', 'Acer'], difficulty: 'medium' },
            { brandName: 'PlayStation', logoUrl: './logo/playstation.png', options: ['Xbox', 'Nintendo', 'PlayStation', 'Sega'], difficulty: 'medium' },
            { brandName: 'Burger King', logoUrl: './logo/burger-king.png', options: ['McDonalds', 'Wendys', 'Burger King', 'KFC'], difficulty: 'medium' },
            { brandName: 'Puma', logoUrl: './logo/puma.png', options: ['Nike', 'Adidas', 'Reebok', 'Puma'], difficulty: 'medium' },
            { brandName: 'Red Bull', logoUrl: './logo/red-bull.png', options: ['Monster', 'Rockstar', 'Red Bull', 'Bang'], difficulty: 'medium' },

            // Hard
            { brandName: 'Facebook', logoUrl: './logo/facebook.png', options: ['Twitter', 'Instagram', 'LinkedIn', 'Facebook'], difficulty: 'hard' },
            { brandName: 'Toyota', logoUrl: './logo/toyota.png', options: ['Honda', 'Ford', 'Toyota', 'BMW'], difficulty: 'hard' },
            { brandName: 'Samsung', logoUrl: './logo/samsung.png', options: ['LG', 'Sony', 'Samsung', 'Panasonic'], difficulty: 'hard' },
            { brandName: 'Netflix', logoUrl: './logo/netflix.png', options: ['Hulu', 'Netflix', 'Amazon Prime Video', 'Disney+'], difficulty: 'hard' },
            { brandName: 'Intel', logoUrl: './logo/intel.png', options: ['AMD', 'Nvidia', 'Qualcomm', 'Intel'], difficulty: 'hard' },
            { brandName: 'Mercedes-Benz', logoUrl: './logo/mercedes-benz.png', options: ['BMW', 'Audi', 'Mercedes-Benz', 'Lexus'], difficulty: 'hard' },
            { brandName: 'Oracle', logoUrl: './logo/oracle.png', options: ['SAP', 'Microsoft', 'Oracle', 'IBM'], difficulty: 'hard' },
            { brandName: 'Adobe', logoUrl: './logo/adobe.png', options: ['Corel', 'Affinity', 'Adobe', 'Autodesk'], difficulty: 'hard' },
            { brandName: 'IBM', logoUrl: './logo/ibm.png', options: ['HP', 'Dell', 'IBM', 'Accenture'], difficulty: 'hard' },
            { brandName: 'SAP', logoUrl: './logo/sap.png', options: ['Oracle', 'Salesforce', 'SAP', 'Workday'], difficulty: 'hard' },
            { brandName: 'General Electric', logoUrl: './logo/general-electric.png', options: ['Siemens', 'Honeywell', 'General Electric', '3M'], difficulty: 'hard' },
            { brandName: 'Cisco', logoUrl: './logo/cisco.png', options: ['Juniper', 'Huawei', 'Cisco', 'Arista'], difficulty: 'hard' },
            { brandName: 'Volkswagen', logoUrl: './logo/volkswagen.png', options: ['Toyota', 'Ford', 'BMW', 'Volkswagen'], difficulty: 'hard' },
            { brandName: 'Chanel', logoUrl: './logo/chanel.png', options: ['Dior', 'Gucci', 'Chanel', 'Prada'], difficulty: 'hard' },
            { brandName: 'Rolex', logoUrl: './logo/rolex.png', options: ['Omega', 'Tag Heuer', 'Rolex', 'Cartier'], difficulty: 'hard' },

            // New Additions - Easy
            { brandName: 'Spotify', logoUrl: './logo/spotify.png', options: ['SoundCloud', 'Apple Music', 'Spotify', 'Deezer'], difficulty: 'easy' },
            { brandName: 'WhatsApp', logoUrl: './logo/whatsapp.png', options: ['Viber', 'Telegram', 'WhatsApp', 'WeChat'], difficulty: 'easy' },
            { brandName: 'Tesla', logoUrl: './logo/tesla.png', options: ['Rivian', 'Lucid', 'Tesla', 'Nio'], difficulty: 'easy' },
            { brandName: 'FedEx', logoUrl: './logo/fedex.png', options: ['UPS', 'DHL', 'FedEx', 'USPS'], difficulty: 'easy' },
            { brandName: '7-Eleven', logoUrl: './logo/7-eleven.png', options: ['Circle K', 'Wawa', '7-Eleven', 'Sheetz'], difficulty: 'easy' },

            // New Additions - Medium
            { brandName: 'Ferrari', logoUrl: './logo/ferrari.png', options: ['Lamborghini', 'Maserati', 'Ferrari', 'Bugatti'], difficulty: 'medium' },
            { brandName: 'Porsche', logoUrl: './logo/porsche.png', options: ['Ferrari', 'Audi', 'Porsche', 'Bentley'], difficulty: 'medium' },
            { brandName: 'Nikon', logoUrl: './logo/nikon.png', options: ['Canon', 'Sony', 'Nikon', 'Fujifilm'], difficulty: 'medium' },
            { brandName: 'Canon', logoUrl: './logo/canon.png', options: ['Nikon', 'Olympus', 'Canon', 'Panasonic'], difficulty: 'medium' },
            { brandName: 'Nintendo', logoUrl: './logo/nintendo.png', options: ['Sega', 'Sony', 'Nintendo', 'Xbox'], difficulty: 'medium' },

            // New Additions - Hard
            { brandName: 'Unilever', logoUrl: './logo/unilever.png', options: ['P&G', 'Nestle', 'Unilever', 'Kraft Heinz'], difficulty: 'hard' },
            { brandName: 'NestlÃ©', logoUrl: './logo/nestle.png', options: ['Danone', 'Mars', 'NestlÃ©', 'Mondelez'], difficulty: 'hard' },
            { brandName: 'Goldman Sachs', logoUrl: './logo/goldman-sachs.png', options: ['JP Morgan', 'Morgan Stanley', 'Goldman Sachs', 'Citi'], difficulty: 'hard' },
            { brandName: 'HermÃ¨s', logoUrl: './logo/hermes.png', options: ['Gucci', 'Louis Vuitton', 'HermÃ¨s', 'Prada'], difficulty: 'hard' },
            { brandName: 'Jaguar', logoUrl: './logo/jaguar.png', options: ['Land Rover', 'Aston Martin', 'Jaguar', 'Bentley'], difficulty: 'hard' }
        ];

        allQuestions = LOGO_DATA;

        // --- UTILITY FUNCTIONS ---
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
            }
        }

        function shuffleArray(array) {
            // Fisher-Yates shuffle algorithm
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function showMessage(text, type = 'info', duration = 3000) {
            messageBox.textContent = text;
            messageBox.className = 'message-box';
            messageBox.classList.add(type);
            messageBox.style.display = 'block';
            void messageBox.offsetWidth;
            messageBox.classList.add('visible');

            setTimeout(() => {
                messageBox.classList.remove('visible');
                setTimeout(() => {
                    messageBox.style.display = 'none';
                }, 500);
            }, duration - 500 < 0 ? duration : duration - 500);
        }

        function playSound(type) {
            if (!soundEffectsEnabled || !audioCtx) return;
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            gainNode.gain.setValueAtTime(0.05, audioCtx.currentTime);

            oscillator.start(audioCtx.currentTime);

            let duration = 0.1;
            if (type === 'correct') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
                duration = 0.3;
            } else if (type === 'incorrect') {
                oscillator.type = 'square';
                oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
                duration = 0.4;
            } else if (type === 'click') {
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(440, audioCtx.currentTime);
                duration = 0.1;
            }
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration);
            oscillator.stop(audioCtx.currentTime + duration);
        }

        // --- MODAL HANDLING ---
        function openModal(modalElement) {
            if (modalElement) modalElement.style.display = "block";
        }
        function closeModal(modalElement) {
            if (modalElement) modalElement.style.display = "none";
        }

        showAboutBtn.addEventListener('click', () => openModal(aboutModal));
        showHowToPlayBtn.addEventListener('click', () => openModal(howToPlayModal));
        closeAboutModal.addEventListener('click', () => closeModal(aboutModal));
        closeHowToPlayModal.addEventListener('click', () => closeModal(howToPlayModal));

        // Close modal if user clicks outside of it
        window.addEventListener('click', (event) => {
            if (event.target == aboutModal) closeModal(aboutModal);
            if (event.target == howToPlayModal) closeModal(howToPlayModal);
        });


        // --- SETTINGS & INITIALIZATION ---
        function updateSettingsUI() {
            // Read values
            // Note: gameMode global variable should be updated here or in the listener? 
            // Better to update globals in the listener or at start of game, but for UI sync we might need it.
            // Let's rely on reading the DOM state for UI updates.
            const selectedMode = document.querySelector('input[name="gameMode"]:checked').value;

            document.body.classList.remove('party-mode', 'streaming-mode');
            const isDarkModeActive = document.body.classList.contains('dark-mode');
            document.body.style.setProperty('--bg-color', isDarkModeActive ? 'var(--dark-bg)' : 'var(--light-bg)');
            document.body.style.setProperty('--text-color', isDarkModeActive ? 'var(--dark-text)' : 'var(--light-text)');

            streamingModeTitle.style.display = 'none';

            if (selectedMode === 'challenge') {
                roundsGroup.style.display = 'none';
                durationGroup.style.display = 'block';
                partyTimerGroup.style.display = 'none';
                streamingTimerGroup.style.display = 'none';
                scoreDisplay.style.display = 'flex';
                roundDisplay.style.display = 'none';
                optionsContainer.style.display = 'grid';
                timerDisplay.style.display = 'block';
            } else if (selectedMode === 'streaming') {
                document.body.classList.add('streaming-mode');
                streamingModeTitle.style.display = 'block';
                roundsGroup.style.display = 'none';
                durationGroup.style.display = 'none';
                partyTimerGroup.style.display = 'none';
                streamingTimerGroup.style.display = 'block';
                scoreDisplay.style.display = 'none';
                roundDisplay.style.display = 'none';
                optionsContainer.style.display = 'none';
                timerDisplay.style.display = 'block';
            } else { // Single or Party
                roundsGroup.style.display = 'block';
                durationGroup.style.display = 'none';
                partyTimerGroup.style.display = 'none';
                streamingTimerGroup.style.display = 'none';
                scoreDisplay.style.display = 'flex';
                roundDisplay.style.display = 'inline';
                optionsContainer.style.display = 'grid';
                if (selectedMode === 'single') {
                    timerDisplay.style.display = 'none';
                } else { // Party mode
                    document.body.classList.add('party-mode');
                    partyTimerGroup.style.display = 'block';
                    timerDisplay.style.display = 'block';
                }
            }
            // Update global gameMode if needed for immediate feedback, though startGame overrides it
            gameMode = selectedMode;
            updateModeInfo();
        }

        // Add listeners once
        gameModeRadios.forEach(radio => radio.addEventListener('change', updateSettingsUI));

        function preloadImages(questionsToPreload) {
            questionsToPreload.forEach(q => {
                const img = new Image();
                img.src = q.logoUrl;
            });
        }

        startGameBtn.addEventListener('click', () => {
            if (!audioCtx && soundEffectsEnabled) {
                try {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.warn("Web Audio API is not supported.", e);
                    soundEffectsEnabled = false;
                    soundEffectsCheckbox.checked = false;
                }
            }
            playSound('click');

            gameMode = document.querySelector('input[name="gameMode"]:checked').value;
            difficulty = document.querySelector('input[name="difficulty"]:checked').value;
            soundEffectsEnabled = soundEffectsCheckbox.checked;

            // Update timer configs
            partyTimerDuration = parseInt(partyTimerInput.value) || 15;
            streamingRevealDuration = parseInt(streamingTimerInput.value) || 7;

            let questionsByDifficulty = allQuestions.filter(q => q.difficulty === difficulty);
            if (questionsByDifficulty.length === 0) {
                showMessage(`No questions available for ${difficulty} difficulty. Try another.`, 'warning');
                return;
            }

            currentQuestions = shuffleArray([...questionsByDifficulty]);

            if (gameMode === 'challenge') {
                totalRounds = currentQuestions.length;
                const durationMinutes = parseInt(sessionDurationSelect.value);
                timeLeft = durationMinutes * 60;
                startSessionTimer();
            } else if (gameMode === 'streaming') {
                totalRounds = currentQuestions.length;
            } else { // Single or Party
                totalRounds = parseInt(numRoundsInput.value);
                if (isNaN(totalRounds) || totalRounds <= 0 || totalRounds > 200) {
                    showMessage(`Please enter a valid number of rounds`, 'warning');
                    numRoundsInput.value = 10;
                    return;
                }

                // For Party Mode, we want infinite loop, but totalRounds acts as batch size
                // We don't need to limit if user wants more, but usually we slice for Single
                if (gameMode === 'single') {
                    if (totalRounds > currentQuestions.length) totalRounds = currentQuestions.length;
                    currentQuestions = currentQuestions.slice(0, totalRounds);
                } else if (gameMode === 'party') {
                    // Ensure batch size isn't larger than available questions (repeats handled by reshuffle later)
                    if (totalRounds > currentQuestions.length) totalRounds = currentQuestions.length;
                    currentQuestions = currentQuestions.slice(0, totalRounds);
                }
            }

            // Preload images
            preloadImages(currentQuestions);

            score = 0;
            currentQuestionIndex = 0;
            updateScoreDisplay();

            showScreen('gameScreen');
            updateSettingsUI();
            loadQuestion();
        });

        // --- GAME LOGIC ---
        function loadQuestion() {
            clearAllTimers();

            if (gameMode === 'streaming') {
                if (currentQuestions.length === 0) {
                    endGame();
                    return;
                }
                if (currentQuestionIndex >= currentQuestions.length) {
                    currentQuestionIndex = 0;
                }
            } else if (currentQuestionIndex >= currentQuestions.length || (gameMode !== 'challenge' && gameMode !== 'party' && currentQuestionIndex >= totalRounds)) {
                // Check if Party Mode ended batch is handled in revealAnswer, but here we can catch boundary
                if (gameMode === 'party') {
                    // Should have been handled by revealAnswer or needs restart
                    // But if we fall through here, safe to End or Restart?
                    // Let's assume revealAnswer handles the loop.
                } else {
                    endGame();
                    return;
                }
            }

            const question = currentQuestions[currentQuestionIndex];
            if (!question) {
                // If we are in party mode and question is missing (maybe index OOB), try to restart batch
                if (gameMode === 'party') {
                    // Fail-safe: restart batch
                    restartPartyBatch();
                    return;
                }
                endGame();
                return;
            }
            logoImg.src = question.logoUrl;
            feedbackMessage.style.display = 'none';
            feedbackMessage.className = 'feedback-message';
            nextQuestionBtn.style.display = 'none';

            if (gameMode === 'streaming') {
                optionsContainer.style.display = 'none';
                timerDisplay.textContent = `Revealing in: ${streamingRevealDuration}s`;
                timeLeft = streamingRevealDuration;
                streamingRevealInterval = setInterval(() => {
                    timeLeft--;
                    timerDisplay.textContent = `Revealing in: ${timeLeft}s`;
                    if (timeLeft <= 0) {
                        clearInterval(streamingRevealInterval);
                        revealAnswerAndLoadNextStreaming();
                    }
                }, 1000);
            } else {
                optionsContainer.style.display = 'grid';
                optionsContainer.innerHTML = '';
                const displayOptions = shuffleArray([...question.options]);
                displayOptions.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.classList.add('btn', 'btn-option');
                    button.textContent = option;
                    button.dataset.option = option;
                    button.addEventListener('click', handleGuess);
                    button.dataset.key = String.fromCharCode(65 + index);
                    optionsContainer.appendChild(button);
                });
                updateRoundDisplay();
                if (gameMode === 'party' || gameMode === 'challenge') {
                    startQuestionTimer(gameMode === 'party' ? partyTimerDuration : 15);
                }
            }
        }

        function restartPartyBatch() {
            showMessage("Loading more logos...", "success", 1000);
            let questionsByDifficulty = allQuestions.filter(q => q.difficulty === difficulty);
            currentQuestions = shuffleArray([...questionsByDifficulty]);
            let batchSize = parseInt(numRoundsInput.value) || 10;
            if (batchSize > questionsByDifficulty.length) batchSize = questionsByDifficulty.length;
            totalRounds = batchSize;
            currentQuestions = currentQuestions.slice(0, totalRounds);
            currentQuestionIndex = 0;
            loadQuestion();
        }

        updateModeInfo();


        function updateModeInfo() {
            let label = '';
            let instruction = '';
            switch (gameMode) {
                case 'single':
                    label = 'Single Player';
                    instruction = 'Take your time and guess the logo.';
                    break;
                case 'party':
                    label = 'Party Mode';
                    instruction = `Guess quickly! You have ${partyTimerDuration} seconds per logo.`;
                    break;
                case 'challenge':
                    label = 'Challenge Mode';
                    instruction = 'Answer as many as you can before the session ends!';
                    break;
                case 'streaming':
                    label = 'Streaming Mode';
                    instruction = 'Sit back and watch the answers reveal.';
                    break;
            }
            if (currentModeLabel) currentModeLabel.textContent = label;
            if (modeInstruction) modeInstruction.textContent = instruction;
        }

        function revealAnswerAndLoadNextStreaming() {
            const question = currentQuestions[currentQuestionIndex];
            if (!question) { // Safety check
                loadQuestion(); // Try to load next or reset
                return;
            }
            feedbackMessage.textContent = `The answer is: ${question.brandName}`;
            feedbackMessage.className = 'feedback-message info';
            feedbackMessage.style.display = 'block';
            playSound('correct');

            timerDisplay.textContent = `Next in: ${STREAMING_NEXT_DELAY}s`;
            timeLeft = STREAMING_NEXT_DELAY;
            streamingNextInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Next in: ${timeLeft}s`;
                if (timeLeft <= 0) {
                    clearInterval(streamingNextInterval);
                    currentQuestionIndex++;
                    loadQuestion();
                }
            }, 1000);
        }


        function updateScoreDisplay() {
            scoreDisplay.textContent = `Score: ${score}`;
        }

        function updateRoundDisplay() {
            if (gameMode !== 'challenge' && gameMode !== 'streaming') {
                roundDisplay.textContent = `Round: ${currentQuestionIndex + 1}/${totalRounds}`;
            } else if (gameMode === 'challenge') {
                roundDisplay.textContent = `Question: ${currentQuestionIndex + 1}`;
            }
        }

        function clearAllTimers() {
            clearInterval(questionTimerInterval);
            clearInterval(sessionTimerInterval);
            clearInterval(streamingRevealInterval);
            clearInterval(streamingNextInterval);
        }

        function startQuestionTimer(duration) {
            clearAllTimers();
            timeLeft = duration;
            timerDisplay.textContent = `Time: ${timeLeft}s`;
            questionTimerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Time: ${timeLeft}s`;
                if (timeLeft <= 0) {
                    clearInterval(questionTimerInterval);
                    handleTimeout();
                }
            }, 1000);
        }

        function startSessionTimer() {
            clearAllTimers();
            timerDisplay.textContent = `Session Time: ${formatTime(timeLeft)}`;
            sessionTimerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Session Time: ${formatTime(timeLeft)}`;
                if (timeLeft <= 0) {
                    clearInterval(sessionTimerInterval);
                    if (gameScreen.classList.contains('active')) {
                        showMessage("Session time's up!", 'info');
                        endGame();
                    }
                }
            }, 1000);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }


        function handleTimeout() {
            if (!currentQuestions[currentQuestionIndex]) return; // Safety check
            feedbackMessage.textContent = "Time's up! The correct answer was: " + currentQuestions[currentQuestionIndex].brandName;
            feedbackMessage.className = 'feedback-message info';
            feedbackMessage.style.display = 'block';
            playSound('incorrect');
            revealAnswer(null);
        }

        function handleGuess(event) {
            clearInterval(questionTimerInterval);
            if (!currentQuestions[currentQuestionIndex]) return; // Safety check

            const selectedOption = event.target.dataset.option;
            const correctAnswer = currentQuestions[currentQuestionIndex].brandName;

            if (selectedOption === correctAnswer) {
                score++;
                feedbackMessage.textContent = 'Correct!';
                feedbackMessage.className = 'feedback-message correct';
                playSound('correct');
            } else {
                feedbackMessage.textContent = `Incorrect. Correct answer: ${correctAnswer}`;
                feedbackMessage.className = 'feedback-message incorrect';
                playSound('incorrect');
            }
            feedbackMessage.style.display = 'block';
            updateScoreDisplay();
            revealAnswer(selectedOption);
        }

        function revealAnswer(selectedOptionText) {
            if (!currentQuestions[currentQuestionIndex]) return; // Safety check
            const correctAnswer = currentQuestions[currentQuestionIndex].brandName;
            document.querySelectorAll('.btn-option').forEach(btn => {
                btn.disabled = true;
                if (btn.dataset.option === correctAnswer) {
                    btn.classList.add('correct');
                } else if (btn.dataset.option === selectedOptionText && selectedOptionText !== correctAnswer) {
                    btn.classList.add('incorrect');
                }
            });

            if (gameMode === 'party') {
                // Party Mode Interstitial
                let interstitialTime = 4;
                timerDisplay.textContent = `Next logo in: ${interstitialTime}s`;

                const partyNextInterval = setInterval(() => {
                    interstitialTime--;
                    timerDisplay.textContent = `Next logo in: ${interstitialTime}s`;
                    if (interstitialTime <= 0) {
                        clearInterval(partyNextInterval);
                        currentQuestionIndex++;
                        if (currentQuestionIndex >= totalRounds) {
                            // Infinite Party Mode: Restart Batch
                            restartPartyBatch();
                        } else {
                            loadQuestion();
                        }
                    }
                }, 1000);
            } else if (gameMode === 'challenge' && timeLeft > 0) {
                setTimeout(() => {
                    currentQuestionIndex++;
                    loadQuestion();
                }, 2000);
            } else if (gameMode === 'single') {
                if (currentQuestionIndex < totalRounds - 1) {
                    nextQuestionBtn.textContent = 'Next Question';
                    nextQuestionBtn.style.display = 'block';
                } else {
                    nextQuestionBtn.textContent = 'Show Results';
                    nextQuestionBtn.style.display = 'block';
                }
            } else if (gameMode === 'challenge' && timeLeft <= 0) {
                setTimeout(endGame, 2000);
            } else {
                setTimeout(endGame, 2000);
            }
        }

        nextQuestionBtn.addEventListener('click', () => {
            playSound('click');
            currentQuestionIndex++;
            if (currentQuestionIndex >= totalRounds && gameMode !== 'challenge') {
                endGame();
            } else {
                loadQuestion();
            }
        });

        function endGame() {
            clearAllTimers();
            showScreen('gameOverScreen');

            if (gameMode === 'streaming') {
                finalScoreDisplay.textContent = "Streaming session ended. Select 'Play Again' to return to settings.";
                highscoreSection.style.display = 'none';
                shareScoreBtn.style.display = 'none';
            } else {
                highscoreSection.style.display = 'block';
                shareScoreBtn.style.display = 'inline-block';
                let resultText = `You scored ${score} out of ${currentQuestionIndex > 0 ? currentQuestionIndex : totalRounds} questions attempted.`;
                if (gameMode !== 'challenge') {
                    resultText = `You scored ${score} out of ${totalRounds} rounds.`;
                }
                finalScoreDisplay.textContent = resultText;
                saveHighScore(score, gameMode, difficulty, gameMode === 'challenge' ? currentQuestionIndex : totalRounds);
                displayHighScores();
            }
        }

        // --- HIGH SCORES (localStorage) ---
        function saveHighScore(currentScore, mode, diff, questionsOrRounds) {
            if (mode === 'streaming') return;
            try {
                const highScores = JSON.parse(localStorage.getItem('guessLogoHighScores') || '[]');
                const scoreEntry = {
                    score: currentScore,
                    mode: mode,
                    difficulty: diff,
                    rounds: questionsOrRounds,
                    date: new Date().toLocaleDateString()
                };
                highScores.push(scoreEntry);
                highScores.sort((a, b) => b.score - a.score || b.rounds - a.rounds);
                highScores.splice(10);
                localStorage.setItem('guessLogoHighScores', JSON.stringify(highScores));
            } catch (e) {
                console.error("Could not save high score:", e);
            }
        }

        function displayHighScores() {
            if (gameMode === 'streaming' && gameOverScreen.classList.contains('active')) return;
            try {
                const highScores = JSON.parse(localStorage.getItem('guessLogoHighScores') || '[]');
                highscoreList.innerHTML = '';
                if (highScores.length === 0) {
                    highscoreList.innerHTML = '<li>No high scores yet!</li>';
                    return;
                }
                highScores.forEach(entry => {
                    const li = document.createElement('li');
                    li.textContent = `${entry.score}/${entry.rounds} (${entry.difficulty}, ${entry.mode}) - ${entry.date}`;
                    highscoreList.appendChild(li);
                });
            } catch (e) {
                console.error("Could not display high scores:", e);
                highscoreList.innerHTML = '<li>Error loading scores.</li>';
            }
        }

        playAgainBtn.addEventListener('click', () => {
            playSound('click');
            scoreDisplay.style.display = 'flex';
            roundDisplay.style.display = 'inline';
            optionsContainer.style.display = 'grid';
            highscoreSection.style.display = 'block';
            shareScoreBtn.style.display = 'inline-block';
            streamingModeTitle.style.display = 'none';

            showScreen('settingsScreen');
            document.getElementById('modeSingle').checked = true;
            updateSettingsUI();
        });

        shareScoreBtn.addEventListener('click', () => {
            playSound('click');
            const textToCopy = `I scored ${score} in Guess The Logo! (Mode: ${gameMode}, Difficulty: ${difficulty}, Rounds/Questions: ${gameMode === 'challenge' ? currentQuestionIndex : totalRounds}). Try it out!`;
            const textArea = document.createElement('textarea');
            textArea.value = textToCopy;
            textArea.style.position = 'fixed';
            textArea.style.left = '-9999px';
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showMessage('Score copied to clipboard!', 'success', 2000);
            } catch (err) {
                showMessage('Failed to copy score.', 'error', 2000);
            }
            document.body.removeChild(textArea);
        });

        // --- DARK MODE ---
        darkModeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('guessLogoDarkMode', isDarkMode);
            darkModeToggle.textContent = isDarkMode ? 'â˜€ï¸' : 'ï¿½';

            // CSS variables should handle the theme changes via :root and .dark-mode
            // Explicitly setting body styles here might be redundant but kept for safety
            document.body.style.setProperty('--bg-color', isDarkMode ? 'var(--dark-bg)' : 'var(--light-bg)');
            document.body.style.setProperty('--text-color', isDarkMode ? 'var(--dark-text)' : 'var(--light-text)');
            playSound('click');
        });

        function loadDarkModePreference() {
            const isDarkMode = localStorage.getItem('guessLogoDarkMode') === 'true';
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                darkModeToggle.textContent = 'â˜€ï¸';
            } else {
                document.body.classList.remove('dark-mode');
                darkModeToggle.textContent = 'ðŸŒ™';
            }
            document.body.style.setProperty('--bg-color', isDarkMode ? 'var(--dark-bg)' : 'var(--light-bg)');
            document.body.style.setProperty('--text-color', isDarkMode ? 'var(--dark-text)' : 'var(--light-text)');
        }

        // --- KEYBOARD INPUT ---
        document.addEventListener('keydown', (event) => {
            const isInteractiveScreen = gameScreen.classList.contains('active') ||
                settingsScreen.classList.contains('active') ||
                gameOverScreen.classList.contains('active');

            if (gameMode === 'streaming' && gameScreen.classList.contains('active')) return;
            if (!isInteractiveScreen) return;

            // Close modals with Escape key
            if (event.key === 'Escape') {
                if (aboutModal.style.display === 'block') closeModal(aboutModal);
                if (howToPlayModal.style.display === 'block') closeModal(howToPlayModal);
                return; // Prevent other key actions if a modal was closed
            }

            const key = event.key.toUpperCase();
            let buttonToClick = null;

            if (gameScreen.classList.contains('active') && optionsContainer.children.length > 0 && optionsContainer.style.display !== 'none') {
                if (key >= '1' && key <= '4') {
                    buttonToClick = optionsContainer.children[parseInt(key) - 1];
                } else if (key >= 'A' && key <= 'D') {
                    for (let i = 0; i < optionsContainer.children.length; i++) {
                        if (optionsContainer.children[i].dataset.key === key) {
                            buttonToClick = optionsContainer.children[i];
                            break;
                        }
                    }
                } else if ((key === 'ENTER' || key === ' ') && nextQuestionBtn.style.display !== 'none' && !nextQuestionBtn.disabled) {
                    buttonToClick = nextQuestionBtn;
                }
            }

            if ((key === 'ENTER' || key === ' ') && !buttonToClick) {
                if (settingsScreen.classList.contains('active') && startGameBtn.offsetParent !== null) {
                    buttonToClick = startGameBtn;
                } else if (gameOverScreen.classList.contains('active') && playAgainBtn.offsetParent !== null) {
                    buttonToClick = playAgainBtn;
                }
            }


            if (buttonToClick && !buttonToClick.disabled) {
                event.preventDefault();
                buttonToClick.click();
            }
        });


        // --- INITIAL LOAD ---
        window.addEventListener('load', () => {
            loadDarkModePreference();
            updateSettingsUI();
            showScreen('settingsScreen');
        });

    </script>
</body>

</html>